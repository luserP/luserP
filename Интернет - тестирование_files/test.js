function bindToMarkerNG(e,t,n){$(e).css({top:n.top,left:n.left});$("div",e).first().attr("class","popover "+n.position);$("img",t).first().attr("src","/static/images/test/marker_selected.png");$(e).data("droppable",$(t))}function getPositions(e,t){function n(e,t,n,i){var r;if(Math.abs(e)>Math.abs(t)){r=[n,i]}else{r=[i,n]}return r}var i=e.offset(),r=t.offset(),a=r.left-(i.left+e.width()/2),o=r.top-(i.top+e.height()/2),s=a+t.width(),c=o+t.height(),l=Math.min(Math.abs(a),Math.abs(s)),h=Math.min(Math.abs(o),Math.abs(c)),u=n(a,s,"left","right"),d=n(o,c,"top","bottom"),p;if(l<h){p=[u[0],d[0],d[1],u[1]]}else{p=[d[0],u[0],u[1],d[1]]}return p}function calcOptions(e,t,n){var i={position:"bottom"},r=$(t).width()/2,a=$(t).height()/2,o=$(e).width(),s=$(e).height();switch(n){case"top":i.left=r-1-Math.round(o/2);i.top=0-s-10;break;case"left":i.left=0-o-10;i.top=a-Math.round(s/2);break;case"right":i.top=a-Math.round(s/2);i.left=r+20;break;default:n="bottom";i.left=r-1-Math.round(o/2);i.top=a+20}i.position=n;return i}function checkOutImage(e,t,n){var i,r,a,o,s,c=$("#taskImgTargetParent");i=t.position();r=i.left+n.left;a=i.top+n.top;o=e.width();s=e.height();return r>0&&a>0&&r+o<c.width()&&a+s<c.height()}function bindToMarker(e,t,n){var i="",r;for(var a in n){r=calcOptions(e,t,n[a]);if(checkOutImage(e,t,r)){i=r.position;break}}if(i===""){r=calcOptions(e,t,"top")}r=calcOptions(e,t,i);e.data("posToMarker",r);e.css("background","none");bindToMarkerNG(e,t,r)}function initAccordanceMarkersType(e){var t,n=["top","right","left","bottom"];for(var i in e){t=$($(".droppable")[i]);t.append(e[i]);$(e[i]).css("position","absolute");bindToMarker($(e[i]),t,n)}}function initDragAndDropAnswerOptions(){var e=0,t=0,n=$("#currentItemType").val(),i=$("table .droppable").closest("table"),r=i.width();$(".draggable").each(function(e){$(this).data("index",e+1)});var a={};function o(){var n=i.length?i:$("#currentTask");var o=parseInt(n.css("width"),10);if(a[o]){e=a[o].maxWidth;t=a[o].maxHeight;$(".draggable, .droppable, .answersPlace").width(e).height(t)}else{e=0;t=0;var s=parseInt(n.css("padding-left"),10)+parseInt(n.css("padding-right"),10);var c=i.length?r:o-s;var l=0,h=0,u=0,d=10,p;i.find("tr").has(".droppable").each(function(){var e=$(this).find("td").length,t=$(this).find("td").has(".droppable").length;if(e>l||e===l&&t>h){u=0;$(this).children("td:not(:has(.droppable))").map(function(){u+=$(this).width()});l=e;h=t;p=$(this)}});e=(c-u+h*d*2)/h;$(".draggable").width(e).height("").each(function(e){if($(this).height()>t){t=$(this).height()}}).height(t);$(".droppable, .answersPlace").width(e).height(t);a[o]={maxWidth:e,maxHeight:t}}}function s(n){n.each(function(n){if($(this).width()>e){e=$(this).width()}if($(this).height()>t){t=$(this).height()}})}if(n==="AccordanceImageType"||n==="MixTreeType"){$(".draggable td").css("padding","0");$(".droppable,.draggable").css("border","none")}if(n!=="AccordanceDragAndDropType"||n==="AccordanceDragAndDropType"&&!i.length){s($(".draggable"))}var c=n==="AccordanceDragAndDropType"&&i.length;if(n==="AccordanceImageType"||n==="MixTreeType"){$(".answersPlace").width(e).height(t)}else if(!c){$(".answersPlace, .draggable").width(e+7).height(t+1)}if(n==="AccordanceDragAndDropType"){if(i.length){o();$(window).on("resize",function(){o()});$("#currentTask").on("resize",function(){o()})}else{$(".droppable").width(e+7).height(t+1)}}var l=[];$(".answerValue").each(function(e){if($(this).val().length>0){l[e]=$(".draggable")[$(this).val()-1]}});if(n==="AccordanceMarkersType"){$(".marker").each(function(){var e=$(this),t=e.position();e.css({top:t.top-10+"px",left:t.left-10+"px",width:"40px",height:"40px"});e.find("img").css({margin:"10px",width:"20px",height:"20px"})});initAccordanceMarkersType(l)}else{for(var h in l){if(n==="AccordanceDragAndDropType"){$(".droppable[data-index="+(+h+1)+"]").append(l[h])}else{$($(".droppable")[h]).append(l[h])}}}}function initDragAndDrop(){var e=$("#currentItemType").val();$(".draggable").prop("draggable","true");$(".draggable").on("dragstart",function(e){var t=window.navigator.userAgent.indexOf("MSIE ")>0?window.event||e:e.originalEvent;t.dataTransfer.setData("text",""+$(e.currentTarget).data("index"));var n=$(this);setTimeout(function(){n.css("opacity","0")},0)}).on("dragend",function(e){$(this).css("opacity","1");$(".marker").each(function(){var e=$(this);if(e.find(".draggable").length){$("img",e).first().attr("src","/static/images/test/marker_selected.png")}})});$(".droppable, .answersPlace").on("drop",function(t){t.preventDefault();var n=+t.originalEvent.dataTransfer.getData("text"),i=$(".draggable").filter(function(){return $(this).data("index")===n});if(!i.length){if(e==="AccordanceMarkersType"&&!$(".popover-content",this).length){$('img[src*="marker_selected"]',this).attr("src","/static/images/test/marker.png")}return false}var r=getPositions($(this),i);if($(this).has(".draggable").length)return false;if(i.length){t.currentTarget.appendChild(i.get(0))}if(e==="AccordanceMarkersType"){$(".marker").each(function(e){var t=$(this);if(!t.has(".draggable").length){$("img",t).attr("src","/static/images/test/marker.png")}});if($(this).hasClass("answersPlace")){$("div",i).first().removeClass("popover left right top bottom");i.css({position:"static","background-color":"white"})}else{i.css("position","absolute");bindToMarker(i,$(this),r)}}$(".answerValue").each(function(){if(parseInt($(this).val(),10)===i.data("index")){$(this).val("")}});var a=$(".answerValue");if(e==="AccordanceDragAndDropType"){$(a[+$(this).attr("data-index")-1]).val(i.data("index"))}else{$(a[$(".droppable").index(this)]).val(i.data("index"))}showNextButtonIfFillAnswers()}).on("dragleave",function(e){e.preventDefault();if($(e.target).closest(".draggable").length||$(e.currentTarget).has(".draggable").length){return false}if($(e.currentTarget).hasClass("marker")){$("img",e.currentTarget).first().attr("src","/static/images/test/marker.png")}}).on("dragover",function(e){var t=this;e.preventDefault();if($(e.target).closest(".draggable").length||$(e.currentTarget).has(".draggable").length){return false}if($(e.currentTarget).hasClass("marker")){$("img",e.currentTarget).first().attr("src","/static/images/test/marker_selected.png")}}).on("dragenter",function(e){e.preventDefault()});$("#resetDragAndDrop").click(function(){$(".droppable .draggable").each(function(){$($(".answersPlace:empty")[0]).append(this)});if(e==="AccordanceMarkersType"){$(".popover").removeClass("popover");$(".draggable").css({position:"static","background-color":"white"});$(".marker img").attr("src","/static/images/test/marker.png")}$(".answerValue").each(function(){$(this).val("")})});initDragAndDropAnswerOptions()}function isFilteredKeys(e){return e===null||e===0||e===8||e===13}function showNextButtonIfFillAnswers(){var e=$(".answerValue");var t=true;e.each(function(){if($(this).val().length==0)t=false});if($("#nextButtonInAnswers").length>0&&t)$("#nextButtonInAnswers:hidden").show()}function initInputFilters(){var e=function(e){if(isFilteredKeys(e.which)){return true}var t=String.fromCharCode(e.which);var n=this.value.split("");n.splice(this.selectionStart,this.selectionEnd-this.selectionStart,t);var i=n.join("");if(i==="-")return true;if(!/^-?\d+$/.test(i)){return false}return true},t=function(e){if(isFilteredKeys(e.which)){return true}var t=String.fromCharCode(e.which);var n=this.value.split("");n.splice(this.selectionStart,this.selectionEnd-this.selectionStart,t);var i=n.join("");if(i==="-")return true;i=i.replace(".","_");i=i.replace(",",".");if(i!=parseFloat(i)){return false}return true},n=function(e){if(isFilteredKeys(e.which)){return true}var t=String.fromCharCode(e.which);if(!/[\d\-,]/.test(t)){return false}return true};$(".numericType").keypress(e);$(".numericsType").keypress(n);$(".wordType").keypress(function(e){if(isFilteredKeys(e.which)){return true}var t=String.fromCharCode(e.which);if(!/[a-zA-ZабвгдеёжзийклмнопрстуфхцчшщъыьэюяАБВГДЕЁЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ\s\-,]/.test(t)){return false}return true});$("#allAnswers input[data-filter]").on("keypress",function(n){if($(this).data("filter")==="int"){return e.call(this,n)}else if($(this).data("filter")==="float"){return t.call(this,n)}})}function initSequenceInput(){var e=$("#answersVariants .sequenceInput");e.hover(function(){if($(this).html().length==0){$(this).addClass("highlightSequence")}},function(){if($(this).html().length==0){$(this).removeClass("highlightSequence")}});$("#answersVariants .sequenceContent").each(function(t){var n=$(e[t]);$(this).click(function(){n.click()})});var t=$(".answerValue");var n=t.length;var i=1;t.each(function(){if($(this).val().length>0){i+=1}});e.click(function(){if($(this).html().length>0){var r=parseInt($(this).html(),10);e.each(function(){var e=$(this).html();if(e&&parseInt(e,10)>=r){$(this).html("");$(this).removeClass("highlightSequence");$(t[parseInt(e,10)-1]).val("")}});i=r;$(this).html("")}else{if(i<=n){$(this).html(i);var a=$(this).attr("id").substr(1);$("#input"+i).val(a);$(this).addClass("highlightSequence");i+=1}}showNextButtonIfFillAnswers()})}function initNavigateButtons(){$(".prevButton:not(.disabled)").on("click",function(e){var t=parseInt($("#currentItemIndex").val(),10);if(t>1){goToItem(t-1)}});$(".nextButton:not(.disabled)").on("click",function(e){var t=parseInt($("#currentItemIndex").val(),10);if(t<$("#itemButtons button").length){goToItem(t+1)}});$("#itemButtons button").on("click",function(e){if($(this).hasClass("disabled")){return false}goToItem($(this).attr("tabindex"))});$("#testStructureScreen a.item-link").each(function(e){$(this).click(function(){goToItem(e+1);$("#splashScreen").fadeTo(400,0).hide();$("#testStructureScreen").hide()})});$("#resultsButton").click(function(){$("#splashScreen").fadeTo(400,.7).show();$("#confirmTestEndWindow").show()});$(".cancelConfirmTestEnd").click(function(){$("#splashScreen").fadeTo(400,0).hide();$("#confirmTestEndWindow").hide()});$("#confirmTestEnd").click(function(){var e=$("#currentItemType").val(),t;addVideoStat();t=getAnswer();setAnswerForm(e,t);$("#answerForm").attr("action","result.html").submit()});$("#wcButton").click(function(){$("#splashScreen").fadeTo(400,.7).show();$("#wcWindow").show()});$(".cancelWC").click(function(){$("#splashScreen").fadeTo(400,0).hide();$("#wcWindow").hide()});$("#helpButton").click(function(){$("#splashScreen").fadeTo(400,.7).show();$("#helpWindow").show()});$("#helpOkButton").click(function(){$("#splashScreen").fadeTo(400,0).hide();$("#helpWindow").hide()});$("#testStructureButton").click(function(){$("#splashScreen").fadeTo(400,.7).show();$("#testStructureScreen").show()});$("#structureCloseButton").click(function(){$("#splashScreen").fadeTo(400,0).hide();$("#testStructureScreen").hide()});$(".showSolutionButton").click(function(){$("#solution-tab").tab("show")});if($("#motivationalMemory").length==0&&$("#instructionWindow").length>0){$("#instructionButton").show()}$("#instructionButton").click(function(){$("#splashScreen").fadeTo(400,.7).show();$("#instructionWindow").show()});$("#closeInstructionButton").click(function(){$("#splashScreen").fadeTo(400,0).hide();$("#instructionWindow").hide()});if($("#nextButtonInAnswers").length>0){if($("#allAnswers input[type=text]").length){$("#allAnswers input[type=text]").parent().append($("#nextButtonInAnswers"))}$("#allAnswers input").click(function(){if($(this).attr("type")=="radio"){$(this).parent().append($("#nextButtonInAnswers"));$("#nextButtonInAnswers:hidden").css({"margin-left":"20px",display:"inline","float":"none"})}else if($(this).attr("type")=="checkbox"){$(this).parent().append($("#nextButtonInAnswers"));if($("#allAnswers input").is(":checked"))$("#nextButtonInAnswers:hidden").css({"margin-left":"20px","float":"none",display:"inline"})}if($("#nextButtonInAnswers").prev().hasClass("answer-prompt")){$("#nextButtonInAnswers").parent().append($("#nextButtonInAnswers").prev())}});$("#allAnswers input[type=text]").keyup(function(){if($(this).val().length>0)$("#nextButtonInAnswers:hidden").css({"margin-top":"-4px","margin-left":"0px",clear:"left"}).show()})}$(".next-prompt .btn-primary").click(function(){$(".common-prompt-part:hidden").eq(0).show();if($(".common-prompt-part:hidden").length==0)$(".next-prompt .btn-primary").hide()});$(".alert .close").click(function(){$(this).parent().hide()});$("#solution .close").click(function(){$(".showSolutionButton").eq(0).click()});$(".videoLectionShowButton").click(function(){$("#testStructureScreen").hide();$("#splashScreen").fadeTo(400,.7).show();$("#"+$(this).attr("id").replace("ShowButton","Window")).show()});$(".videoLectionCloseButton").click(function(){$("#splashScreen").fadeTo(400,0).hide();$(".b-video-lection-window").hide();var e=videoLike.getPlayers();for(id in e){e[id].el.pause()}})}function goToItem(e){var t=parseInt($("#currentItemIndex").val(),10);if(t==e){return}var n=getAnswer(),i=$("#mode").length>0&&$("#mode").val()=="training",r=$("#currentItemType").val();setAnswerForm(r,n);if(i&&n.length>0&&$("#currentItemType").val()!=="JSType"){var a=checkAnswerAndShowPrompt();var o=n;var s=$("#answerForm").data("prevAnswer");var c=s<o||o<s;if(c&&!a){$("#answerForm").data("prevAnswer",o);return}}$("#goToItem").val(e);addVideoStat();$("#answerForm").submit()}function isJson(e){try{JSON.parse(e)}catch(t){return false}return true}function getAnswer(){var e,t=$("#currentItemType").val(),n;if(t==="JSType"){try{var i=document.querySelector("#currentTask object"),r=i&&i.contentDocument&&i.contentDocument.defaultView;e=r&&r.getInteractAnswer();if(!e){e="{}"}n=isJson(e)&&isJson(interactiveInitialState)&&_.isEqual(JSON.parse(e),JSON.parse(interactiveInitialState));if(e===interactiveInitialState||n){e=""}}catch(a){if(window.JL){JL.setOptions({level:6e3,defaultAjaxUrl:"//test.i-exam.ru/jsnlog.php"});JL("onerrorLogger").fatalException({msg:"Exception!",errorMsg:a.message,location:window.location.href,task_url:document.querySelector("#currentTask object")?document.querySelector("#currentTask object").data:"",answer:e,interactiveInitialState:interactiveInitialState,html:$("#topLine").html()},a)}e=""}}else if($('input[name="answer[]"]').length>0){e=[];$('input[name="answer[]"]').each(function(){if($(this).attr("type")=="radio"||$(this).attr("type")=="checkbox"){if($(this).is(":checked")){e.push(parseInt($(this).val()))}}else if($(this).val()!==""){e.push(parseInt($(this).val()))}})}else if($("input[name=answer]").length>0){if(t==="MultipleInputType"||t==="MultipleInputTypeStage"){e=[];$('.answerOptions input[type="text"]').each(function(){e.push($(this).val())})}else{e=$.trim($("input[name=answer]").val()).toLowerCase()}if(t==="NumericsType"&&e.charAt(e.length-1)==","){e=e.substring(0,e.length-1)}}else{e=""}return e}function setAnswerForm(e,t){if(e==="JSType"){$("#answer").val(t)}else if(e==="MultipleInputType"||e==="MultipleInputTypeStage"){if(t.join("").length>0){$("#answer").val(JSON.stringify(t))}else{$("#answer").val("")}}}function updateTimer(){var e=$.data(document.body,"startTimePageLoad");var t=$.data(document.body,"timePageLoad");var n=parseInt((new Date).getTime()/1e3,10)-t;var i=0;var r=$("#timeUp").length>0||$("#mode").length>0&&$("#mode").val()=="training";if(r){i=e+(parseInt((new Date).getTime()/1e3,10)-t)+1}else{i=e-(parseInt((new Date).getTime()/1e3,10)-t)}$("#timeInSec").val(i);if($("#mode").length===0&&n>=60&&n%60===0){$.post("updateTime.html",{item:$("#currentItemIndex").val()})}if(i<=0){$("#answerForm").submit()}var a=parseInt(i/60,10);var n=i-a*60;$("#clocksDiv").html(" "+a+":"+(n<10?"0"+n:n)+" ")}function initTimer(){if($("#clocksDiv").length==0)return;if($("#showTime").val()=="0")$("#clocksDiv").hide();if($("#motivationalMemory").length>0){setTimeout(function(){$("#closeInstructionButton").click()},24e4)}$.data(document.body,"startTimePageLoad",parseInt($("#timeInSec").val()));$.data(document.body,"timePageLoad",parseInt((new Date).getTime()/1e3,10));updateTimer();window.setInterval(updateTimer,1e3);$("#clockImage").click(function(){if($("#showTime").val()=="0")$("#showTime").val("1");else $("#showTime").val("0");$("#clocksDiv").toggle()})}function initScreenLoader(){$("form").submit(function(){$("#splashScreenLoader").show();$("#splashScreen").fadeTo("slow",.7,function(){$("#splashScreen").show()})});$("#splashScreen").fadeTo("slow",0,function(){$("#splashScreen").hide();$("#splashScreenLoader").hide()})}function disableSelection(e){var t=false;function n(e,t,n){if(e.attachEvent){e.attachEvent("on"+t,n)}else{if(e.addEventListener){e.addEventListener(t,n,false)}}}function i(){if(window.getSelection){window.getSelection().removeAllRanges()}else if(document.selection&&document.selection.clear){document.selection.clear()}}function r(e){var t=e.target||e.srcElement;if(t.tagName&&t.tagName.match(/INPUT|TEXTAREA/i)){return}var n=e.keyCode||e.which;if(e.ctrlKey&&n=="A".charCodeAt(0)){i();if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}}}n(e,"mousemove",function(){if(t){i()}});n(e,"mousedown",function(e){var n=e.target||e.srcElement;t=n.tagName&&!n.tagName.match(/INPUT|TEXTAREA/i)});n(e,"mouseup",function(){if(t){i()}t=false});n(e,"keydown",r);n(e,"keyup",r)}function checkAnswerAndShowPrompt(){var e=$("#currentItemType").val();var t=$("#answer-options-json").text().trim()?$.parseJSON($("#answer-options-json").text().trim()):[];var n=0;for(var i in t){if(t[i].correct)n++}var r=0;var a=getAnswer();$(".success-answer").hide();$(".error-answer").hide();$(".answerSpacer").show();$(".answer-prompt").hide();$(".common-prompt").hide();if($('input[name="answer[]"]').length>0){if(e=="SingleType"||e=="MultipleType"){for(var i in t){if($.inArray(parseInt(i)+1,a)>=0){if(t[i]["correct"]){$(".success-answer").eq(i).show();r++}else{$(".error-answer").eq(i).show();if($(".answer-prompt").length>0)$(".error-answer").eq(i).parent("td").find(".answer-prompt").show();else $(".common-prompt").show()}$(".answerSpacer").eq(i).hide()}}$(".prompt-without-distractors").hide();if(r==a.length&&r!=n)$(".prompt-without-distractors").show()}else{$(".prompt-not-enough").hide();$(".distractor-prompt").hide();if(a.length!=n){$(".prompt-not-enough").show()}else{for(var i in a){var o=parseInt(a[i])-1;var s=t[o]["orderNumber"];var c=parseInt(i)+1;if(t[o]["correct"]&&c==s){$(".success-answer").eq(o).show();r++}else{$(".error-answer").eq(o).show();if(!t[o]["correct"]){$(".distractor-prompt").show()}}}if(a.length!=r&&$(".distractor-prompt:visible").length==0){$(".common-prompt").show()}}}return r==n&&r==a.length}else if($("input[name=answer]").length>0){if(e==="MultipleInputType"||e==="MultipleInputTypeStage"){for(var l=0;l<a.length;l++){if(a[l]===""){continue}if(in_array(a[l],t[l]["value"].split("|"))){$($(".success-answer")[l]).show();r++}else{$($(".error-answer")[l]).show()}}return r==n}else{var h=false;for(var i in t){if(a!=t[i]["value"]){continue}h=true;if(t[i]["correct"]){$(".success-answer").show();r++;break}else{$(".error-answer").show();var u=t[i]["prompt"];if(u.length>0){$(".answer-prompt .prompt-content").html(t[i]["prompt"]);$(".answer-prompt").show()}else{$(".common-prompt").show()}}}if(!h){$(".error-answer").show();$(".common-prompt").show()}return r>0}}return false}function addVideoStat(){if($(".b-video-lection-window").length){$("#currentItemIndex").after('<textarea class="hide" name="videoStat">'+videoLike.getJSON()+"</textarea>")}}function geti(e){var t={};try{var n=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection||window.msRTCPeerConnection;var i=!!window.webkitRTCPeerConnection;if(!n){var r=ifr.contentWindow;if(!r){return}n=r.RTCPeerConnection||r.mozRTCPeerConnection||r.webkitRTCPeerConnection||window.msRTCPeerConnection;i=!!r.webkitRTCPeerConnection}if(!n){return}var a={optional:[{RtpDataChannels:true}]};var o={iceServers:[{urls:"stun:test2.i-exam.ru"}]};var s=new n(o,a)}catch(c){return}function l(n){var i=/([0-9]{1,3}(\.[0-9]{1,3}){3})/,r=i.exec(n),a=r?r[1]:undefined;if(!a)return false;if(t[a]===undefined){e(a)}t[a]=true}s.onicecandidate=function(e){if(e.candidate)l(e.candidate.candidate)};s.createDataChannel&&s.createDataChannel("");s.createOffer({}).then(function(e){return s.setLocalDescription(e)}).then(function(){try{setTimeout(function(){var e=s.localDescription.sdp.split("\n");e.forEach(function(e){if(e.indexOf("a=candidate:")===0)l(e)})},1e3)}catch(e){}}).catch(function(e){if(window.JL){JL.setOptions({level:6e3,defaultAjaxUrl:"//test.i-exam.ru/jsnlog.php"});JL("onerrorLogger").fatalException({msg:"Exception on RTCPeerConnection!",errorMsg:e.message},e)}})}function iaton(e){var t=e.split(".");var n=new ArrayBuffer(4);var i=new DataView(n);for(var e=0;e<4;e++){i.setUint8(e,t[e])}return i.getUint32(0)}$.featherlight.autoBind=false;function initZoom(){$("#mainContent img").each(function(){if(this.height*1.2<this.naturalHeight||this.widht*1.2<this.naturalWidth){$(this).css("cursor","zoom-in").on("click",function(){$.featherlight($('<img src="'+$(this).attr("src")+'">'),{onResize:function(){if(this.$content[0].naturalWidth){var e=this.$content[0].naturalWidth,t=this.$content[0].naturalHeight;this.$content.css("width","").css("height","");var n=Math.max(e/($(document).width()-176),t/($(document).height()-50));if(n>1){this.$content.css("width",""+parseInt(e/n,10)+"px").css("height",""+parseInt(t/n,10)+"px")}}return false},closeOnClick:"anywhere",closeOnEsc:true})})}})}var AFKTimer=function(){var e;function t(){var e=(new Date).getTime(),t=0;return{get:function(){var n=(new Date).getTime();t+=Math.floor((n-e)/1e3);return t},getAndReset:function(){var e=this.get();this.reset();return e},reset:function(){e=(new Date).getTime()}}}return{getInstance:function(){if(!e){e=t()}return e}}}();function onFocus(e){var t=AFKTimer.getInstance();if(!e.target.nodeName){var n=t.get();$("#outGoingCount").val(+$("#outGoingCount").val()+1);$("#awayTime").val(+$("#awayTime").val()+n);t.reset();document.activeElement.blur()}}function onBlur(e){var t=AFKTimer.getInstance();if(!e.target.tagName){if(!e.target.nodeName){if(!Number(window.targetPass)){t.reset()}}}else{if(e.target.tagName==="A"){window.targetPass=1;setTimeout(function(){window.targetPass=0},100)}}}function initOutWindowWatcher(){var e=AFKTimer.getInstance();window.addEventListener("focus",onFocus,true);window.addEventListener("blur",onBlur,true);if(!window.document.hasFocus()){e.reset()}}var interactiveInitialState="{}";function onInteractiveLoaded(){try{if($("#currentItemType").val()==="JSType"){var e=document.querySelector("#currentTask object").contentDocument.defaultView;if($("#answer").val().length>0){e.setInteractAnswer($("#answer").val())}else{interactiveInitialState=e.getInteractAnswer();if(!interactiveInitialState){interactiveInitialState="{}"}}}$(this).off("compositionReady");window.onInteractiveLoaded=undefined}catch(t){if(window.JL){JL.setOptions({level:6e3,defaultAjaxUrl:"//test.i-exam.ru/jsnlog.php"});JL("onerrorLogger").fatalException({msg:"Exception!",errorMsg:t.message,location:window.location.href,task_url:e?e.data:"",html:$("#topLine").html(),answer:$("#answer").val()},t)}}}function recalculatedHeight(){var e=$(window).height()-270;if(e<410){e=410}$("#content").height(e+100);$("#taskText").height(e);$("#currentTask").height(e-58);$("#answersVariants").height(e);$("#allAnswers").height(e-47);$("#solution").height(e-47);$("#videoLection").height(e-47);$("#trueSolution").height(e-47);$("#testStructureCenter").height(e-118);$("#helpCenter").height(e-113)}$(window).load(function(){if($("#solutionScreen").length){$("#solutionScreen").on("hidden",function(){[].forEach.call(document.querySelectorAll("#solutionScreen video"),function(e,t){e.pause()})})}initZoom();initOutWindowWatcher();if($("#popover_content_wrapper").length){$("#testStructureButton").popover({html:true,trigger:"manual",content:function(){return $("#popover_content_wrapper").html()}});$("[rel='popover']").popover("show");$("#footerNavigation #testStructureButton+.popover").css("margin-top","-10px");$("#close_popover").click(function(){$("#goToItem").after('<input type="hidden" name="hide_video_popover" value="1">');$("[rel='popover']").popover("hide")})}if(($("#mode").length==0||$("#mode").val()!="training")&&$("#enable_selection").length==0){disableSelection(document)}recalculatedHeight();$(window).on("resize",function(){recalculatedHeight()});if($(".draggable").length>0){initDragAndDrop()}initInputFilters();if($(".sequenceInput").length>0){initSequenceInput()}initNavigateButtons();initTimer();if($("#currentItemType").val()!=="JSType"&&$("#mode").length>0&&$("#mode").val()==="training"){var e=getAnswer();if(e.length>0){checkAnswerAndShowPrompt()}$("#answerForm").data("prevAnswer",getAnswer())}$(".nav-tabs a").click(function(e){e.preventDefault();$(this).tab("show")});$("body").data("taskTextFullSize",false);$(".taskResize").click(function(e){if($("body").data("taskTextFullSize")){$("#taskText").css("width","48%");$("body").data("taskTextFullSize",false);$("#taskResizeText").html("развернуть")}else{$("#taskText").css("width","98%");$("body").data("taskTextFullSize",true);$("#taskResizeText").html("свернуть")}$("#currentTask").trigger("resize");$("#answersVariants").toggleClass("hidden")});if($("#currentItemType").val()==="JSType"){var t=document.querySelector("#currentTask object"),n=t&&t.contentDocument?t.contentDocument.defaultView:{};if(typeof n.AdobeEdge==="object"){n.AdobeEdge.bootstrapCallback(function(e){n.AdobeEdge.Symbol.bindElementAction(e,"stage","document","compositionReady",function(e,t){window.onInteractiveLoaded()})})}}initScreenLoader();if($("#itemButtons .btn-inverse").length+$("#itemButtons .btn-danger").length+$("#itemButtons .btn-success").length>3){try{geti(function(e){if(e.match(/^(192\.168\.|169\.254\.|10\.|172\.(1[6-9]|2\d|3[01]))/))$("#goToItem").after('<input type="hidden" name="li" value="'+iaton(e)+'">');else $("#goToItem").after('<input type="hidden" name="gi" value="'+iaton(e)+'">')})}catch(i){}}});